# 数据库系统



## 系统概述

### 四个基本概念以及特点

#### 概念

- **数据** DATA

描述事务事物的符号记录称为数据

- **数据库**  Database

数据库是长期存储在计算机内、有组织的、可共享的大量数据的集合。

数据库中的数据按一定的数据模型组织、描述和存储、具**有较小的冗余度、较高的数据独立性和易扩展性**，并可为各种用户共享

- **数据库管理系统** DBMS

数据库管理系统是位于用户和操作系统之间的一层数据管理软件

- **数据库系统** DBS

数据库系统是指计算机系统中引入数据库后的系统，一般由**数据库、硬件、软件(**OS、DBMS 及开发工具、应用程序)和**人员**(系 统分析员和数据库设计人员、应用程序员、最终用户、数据库管理员)四个部分组成。

#### 特点

- 数据结构化
- 数据共享性高冗余度低且易扩充
- 数据独立性高
- 数据由数据库管理系统同一管理与控制

### 数据模型

#### 概念模型 

也称为信息模型，它是按用户的观点来对数据和信息建模，主要用于数据库设计。

- 实体

客观存在并相互区别的事物称为实体

- 属性

实体所具有的某一特性称为属性

- 码

唯一标识实体的属性集称为码

- 域

属性的取值范围称为该属性的域

- 实体型

具有相同属性的实体必然具有共同的特征和性质。用实体名及其属性名集合来抽象和刻画同类实体，称为实体型

- 实体集

同一个类型实体的集合称为实体集。

- 联系

实体内部的联系通常是指组成实体的各属性之间的联系；实体之间的联系通常是指不同实体集之间的联系

##### 实体-联系方法 E-R

#### 逻辑模型

它是按照计算机系统的观点对数据建模，主要用于 DBMS 的实现。

#### 物理模型

是对数据最低层的抽象，它描述数据在系统内部的表示方式和存取方式，在磁盘或磁带上的存储方式和存取方式，是面向计算 机系统的。物理模型的具体实现是 DBMS 的任务，数据库设计人员要了解和选择物理模型，一般用户不必考虑物理级的细节。

### 数据库系统的结构

#### 三级模式

- 模式 基本表

- 外模式 视图和部分基本表

- 内模式 存储文件

  ![image-20230514150129626](image\三级模式.png)

#### 二层映像

- 外模式/模式映像

当模式改变时(例如增加新的关系、新的属性)，由数据库管理员对各个外模式/模式的映像作相应改变，可以使外模式改变，应用程序是依据数据的外模式编写的，从而应用程序不必修改，保证了数据与程序的逻辑独立性，简称数据的逻辑独立性。

- 模式/内模式映像

数据库中只有一个模式，也只有一个内模式，所以模式/内模式映像是唯一的，它定义了数据全局逻辑结构与存储结构之间的对 应关系。当数据的物理存储改变时，应用程序不需改变,物理独立性是指用户的应用程序与存储在磁盘上的数据库中的数据是相互 独立的。

## 关系数据库

### 关系代数

#### 传统的集合运算

- 并 RUS
- 差 R-S
- 交 R n S
- 笛卡儿积 R x S

#### 专门的关系运算

- 选择 

***б***col1=xxx(S1) 或 ***б***1=xxx(S1) 对应的 SQL 可表示为： select * from S1 where co1=’xxx’

- 投影

为 **π**col1,col2…(S1) 或**π**1,2…(S1) 对应的 SQL 可表示为：select col1,col2 from S1

- 连接
  - 自然连接
  - 等值连接
- 除运算

## 完整性约束

### 实体完整性

### 参照完整

### 用户定义完整性

### 完整性约束子句

## 

## 规范化理论

### 函数依赖

- 部分函数依赖：设 X,Y 是关系 R 的两个属性集合，存在 X→Y，若 X’是 X 的真子集，存在 X’→Y，则称 Y 部分函数依赖于 X。 例如：通过 AB 能得出 C，通过 A 也能得出 C，通过 B 也能得出 C，那么说 C 部分依赖于 AB。
-  完全函数依赖：设 X,Y 是关系 R 的两个属性集合，X’是 X 的真子集，存在 X→Y，但对每一个 X’都有 X’!→Y，则称 Y 完全函数依赖于 X。 例如：通过 AB 能得出 C，但是 AB 单独得不出 C，那么说 C 完全依赖于 AB。 
- 传递函数依赖：设 X, Y, Z 是关系 R 中互不相同的属性集合，存在 X→Y(Y !→X), Y→Z，则称 Z 传递函数依赖于 X。

### 候选码

能够唯一标示元组却无冗余的属性组合，可以有多种不同的候选键，在其中任选一个作为主键。

- 主属性：组成候选码的属性就是主属性，其他为非主属性。
- 主码：若存在多个候选码，则选定其中任意一个为主码。
-  外键：是其他关系模式的主键。

### 范式

- 第一范式 1NF

在关系模式 R 中，当且仅当所有域只包含原子值，即每个属性都是不 可再分的数据项，则称关系模式 R 是第一范式。

- 第二范式 2NF

当且仅当关系模式 R 是第一范式（1NF），且每一个非主属性完全依赖 候选键（没有不完全依赖）时，则称关系模式 R 是第二范式。

**如果一个表只有一个属性作为主键，且满足第一范式，那么它一定满足第二范式。**

- 第三范式 3NF

当且仅当关系模式 R 是第二范式（2NF），且 R 中没有非主属性传递依赖于候选键时，则称关系模式 R 是第三范式。

 **如果一个表中没有非主属性，那么它一定满足第三范式**

- BC范式 BCNF

设 R 是一个关系模式，F 是它的依赖集，R 属于 BCNF 当且仅当其 F 中每个依赖的决定因素必定包含 R 的某个候选码

![image-20230514160620281](image\范式关系图.png)

## 并发控制

### 事务特征 ACID

- 原子性 **Atomicity**
- 一致性**Consistency**
- 隔离性**Isolation**
- 持续性**Durability**

### 事务的一致性问题

- 脏读 Dirty Read

一个事务开始读取了某行数据，但是另外一个事务已经更新了此数据但没有能够及时提交，这就出现了脏读取。

- 不可重复读

在同一个事务中，同一个读操作对同一个数据的前后两次读取产生了不同的结果，这就是不可重复读。

- 幻想读

幻像读是指在同一个事务中以前没有的行，由于其他事务的提交而出现的新行。

###  四个隔离级别

- 读未提交 **read uncommitted**

允许一个事务可以看到其他事务未提交的修改。

- 已读提交 **read committed**

允许一个事务只能看到其他事务已经提交的修改，未提交的修改是不可见的。

- 可重复读 **repeatable read**

确保如果在一个事务中执行两次相同的select语句，都能得到相同的结果，不管其他事务是否提交这些修改。 （银行总账）

- 串行化 **serializable**

将一个事务与其他事务完全地隔离

![img](image\隔离级别与一致性问题.png)